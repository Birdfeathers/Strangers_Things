(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{29:function(e,t,s){"use strict";s.r(t);var n=s(8),c=s(5),r=s(1),o=s(16),a=s.n(o),i=s(10),l=s(2),j="https://strangers-things.herokuapp.com/api/2107-CSU-WEB-PT";function d(e,t,s){fetch(j+"/posts",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){e(t.data.posts),s(t.data.posts),console.log(t.data.posts)})).catch(console.error)}var b=s(0),u=function(e){var t=e.setOpenM,s=e.post_id,n=e.token,c="";return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(e,t,s){console.log(j+"/posts/"+e+"/messages"),fetch(j+"/posts/"+e+"/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({message:{content:s}})}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.error)}(s,n,c),console.log(s),t(!1)},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:" Message: "}),Object(b.jsx)("input",{type:"text",onChange:function(e){c=e.target.value,e.target.value=c}})]}),Object(b.jsx)("input",{type:"submit"})]})},h=function(e){var t=e.element,s=e.token,n=e.me,o=e.setPosts,a=e.setPostsToDisplay,i=e.history,l=Object(r.useState)(!1),h=Object(c.a)(l,2),O=h[0],m=h[1];return Object(b.jsxs)("div",{className:"post",children:[Object(b.jsxs)("div",{className:"titleBox",children:[Object(b.jsxs)("h2",{children:[" ",t.title]}),Object(b.jsxs)("p",{children:[" ",Object(b.jsx)("b",{children:"Price: "})," ",t.price]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Will Deliver: "}),t.willDeliver?"yes":"no"]})]}),Object(b.jsx)("div",{children:n?Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Active:"}),t.active?"yes":"no"]}):Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Author: "})," ",t.author.username]})}),Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Location: "})," ",t.location]})}),Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Description: "}),t.description]})}),t.isAuthor||n?Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:Object(b.jsx)("b",{children:"Messages: "})}),t.messages.map((function(e,t){return Object(b.jsxs)("div",{className:"message",children:[Object(b.jsxs)("div",{className:"border",children:[Object(b.jsx)("b",{children:"Author:"})," ",e.fromUser.username," "]}),Object(b.jsxs)("div",{children:[e.content," "]})]},t)})),t.isAuthor?Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{onClick:function(){!function(e,t,s,n){fetch(j+"/posts/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(e){console.log(e),d(s,t,n)})).catch(console.error)}(t._id,s,o,a)},children:"Delete Post "}),Object(b.jsx)("button",{onClick:function(){i.push("/edit/"+t._id)},children:"Edit Post"})]}):null]}):null,t.isAuthor||!s||n?null:Object(b.jsx)("div",{children:Object(b.jsx)("button",{onClick:function(){m(!0)},children:"Send Message to Poster"})}),O?Object(b.jsx)(u,{setOpenM:m,post_id:t._id,token:s}):null]})},O=function(){return Object(b.jsx)("div",{className:"error",children:"Error, passwords do not match! "})},m=function(){return Object(b.jsx)("div",{className:"error",children:"Error, username or password are incorrect!"})},x=function(e){var t=e.mode,s=e.setToken,n="login"==t,o=Object(r.useState)(!1),a=Object(c.a)(o,2),i=a[0],l=a[1],d=Object(r.useState)(!1),u=Object(c.a)(d,2),h=u[0],x=u[1];return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=document.getElementById("username").value,c=document.getElementById("password").value;n?function(e,t,s,n){fetch(j+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:e,password:t}})}).then((function(e){return e.json()})).then((function(e){console.log(e.success),e.success?(console.log(e),s(e.data.token),localStorage.setItem("token",e.data.token),console.log(e.data.token),n(!1)):n(!0)})).catch(console.error)}(t,c,s,x):c!=document.getElementById("confirmPassword").value?l(!0):(!function(e,t,s){fetch(j+"/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:e,password:t}})}).then((function(e){return e.json()})).then((function(e){console.log(e),s(e.data.token),console.log(e.data.token),localStorage.setItem("token",e.data.token)})).catch(console.error)}(t,c,s),l(!1))},children:[n?Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Login"})}):Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Register"})}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"username",className:"form-label",children:" UserName: "}),Object(b.jsx)("input",{id:"username",type:"text",className:"form-control",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"password",className:"form-label",children:" Password: "}),Object(b.jsx)("input",{id:"password",type:"password",className:"form-control",required:"required"})]}),n?null:Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{htmlFor:"confirmPassword",className:"form-label",children:" Confirm Password : "}),Object(b.jsx)("input",{id:"confirmPassword",type:"password",className:"form-control",required:"required"})]}),Object(b.jsx)("input",{type:"submit"}),i?Object(b.jsx)(O,{}):null,h?Object(b.jsx)(m,{}):null]})},p=function(e){var t,s,n,c,r,o=e.token,a=e.history,i=e.setPosts,l=e.setPostsToDisplay;return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Create Post"})}),o?Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t&&s&&n?(!function(e,t,s,n,c,r){fetch(j+"/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify({post:{title:t,description:s,price:n,location:c,willDeliver:r}})}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.error)}(o,t,s,n,c,r),d(i,o,l),a.push("/posts")):console.log("Missing required fields")},children:[Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Title: "}),Object(b.jsx)("input",{type:"text",onChange:function(e){t=e.target.value,e.target.value=t},className:"form-control",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Description: "}),Object(b.jsx)("textarea",{onChange:function(e){s=e.target.value,e.target.value=s},className:"form-control",rows:"3",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Price: "}),Object(b.jsx)("input",{type:"text",onChange:function(e){n=e.target.value,e.target.value=n},className:"form-control",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Location: "}),Object(b.jsx)("input",{type:"text",onChange:function(e){c=e.target.value,e.target.value=c},className:"form-control"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"WillDeliver"}),Object(b.jsx)("input",{type:"checkbox",onChange:function(e){r=e.target.checked,e.target.checked=r}})]}),Object(b.jsx)("input",{type:"submit"})]}):Object(b.jsx)("p",{children:"You can only create posts when you are signed in."})]})};var f=function(e){var t=e.setSearchTerm,s=e.searchTerm,n=e.setPostsToDisplay,c=e.posts,r="";return Object(b.jsxs)("form",{children:[Object(b.jsx)("label",{children:"Search:"}),Object(b.jsx)("input",{id:"searchbox",type:"text",onChange:function(e){r=e.target.value,e.target.value=r,t(r);var o=c.filter((function(e){return function(e,t){return t=t.toLowerCase(),!!e.title.toLowerCase().includes(t)||!!e.description.toLowerCase().includes(t)}(e,r)}));n(s.length?o:c)}}),Object(b.jsx)("button",{onClick:function(){t(""),n(c),document.getElementById("searchbox").value=""},children:"Remove Filter"}),s?Object(b.jsx)("div",{children:Object(b.jsxs)("p",{children:[' Posts filtered by term "',s,'"']})}):null]})},g=function(e){var t=e.message,s=e.id,n=(e.token,s===t.fromUser._id);return console.log(t.post),n?Object(b.jsxs)("div",{className:"post",children:[Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Post: "}),t.post.title]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("b",{children:"Content: "}),t.content]})]}):null},v=function(e){var t=e.token,s=Object(r.useState)({}),n=Object(c.a)(s,2),o=n[0],a=n[1];Object(r.useEffect)((function(){t&&function(e,t){fetch(j+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then((function(e){return e.json()})).then((function(e){console.log(e),t(e)})).catch(console.error)}(t,a)}),[t]);var i=o.data;return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Home"})}),o.data?Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:Object(b.jsx)("b",{children:"Posts:"})}),o.data.posts.map((function(e,s){return Object(b.jsx)(h,{element:e,token:t,me:!0},s)})),Object(b.jsx)("p",{children:Object(b.jsx)("b",{children:"Messages Sent: "})}),o.data.messages.map((function(e,s){return Object(b.jsx)(g,{className:"post",message:e,id:i._id,token:t},s)}))]}):Object(b.jsx)("p",{children:"You are not logged in."})]})},N=function(e){var t,s,n,c,r,o=e.token,a=e.history,i=e.match,l=e.setPosts,u=e.setPostsToDisplay,h=(0,e.findPost)(e.posts,i.params.postid);return h&&(t=h.title,s=h.description,n=h.price,c=h.location,r=h.willDeliver),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Edit Post"})}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(e,t,s,n,c,r,o){fetch(j+"/posts/"+e,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({post:{title:s,description:n,price:c,location:r,willDeliver:o}})}).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.error)}(i.params.postid,o,t,s,n,c,r),d(l,o,u),a.push("/posts")},children:[Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Title: "}),Object(b.jsx)("input",{type:"text",defaultValue:t,onChange:function(e){t=e.target.value,e.target.value=t},className:"form-control",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Description: "}),Object(b.jsx)("textarea",{defaultValue:s,onChange:function(e){s=e.target.value,e.target.value=s},className:"form-control",rows:"3",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Price: "}),Object(b.jsx)("input",{defaultValue:n,type:"text",onChange:function(e){n=e.target.value,e.target.value=n},className:"form-control",required:"required"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"Location: "}),Object(b.jsx)("input",{type:"text",defaultValue:c,onChange:function(e){c=e.target.value,e.target.value=c},className:"form-control"})]}),Object(b.jsxs)("div",{className:"mb-3",children:[Object(b.jsx)("label",{className:"form-label",children:"WillDeliver"}),Object(b.jsx)("input",{type:"checkbox",defaultChecked:r,onChange:function(e){r=e.target.checked,e.target.checked=r}})]}),Object(b.jsx)("input",{type:"submit"})]})]})};function y(e,t){return e.find((function(e){return e._id===t}))}var k=function(e){var t=e.setToken;return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"LogOut"})}),Object(b.jsx)("p",{children:"You are logged in, would you like to log out?"}),Object(b.jsx)("button",{type:"button",onClick:function(){t(""),localStorage.setItem("token","")},children:"Log out"})]})},P=function(){var e=Object(r.useState)([]),t=Object(c.a)(e,2),s=t[0],o=t[1],a=Object(r.useState)(""),u=Object(c.a)(a,2),O=u[0],m=u[1],g=Object(r.useState)(""),P=Object(c.a)(g,2),T=P[0],C=P[1],S=Object(r.useState)([]),w=Object(c.a)(S,2),D=w[0],q=w[1],E=Object(r.useState)(""),A=Object(c.a)(E,2),B=A[0],L=A[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token");e&&m(e),d(o,e,q),e&&function(e,t){fetch(j+"/test/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then((function(e){return e.json()})).then((function(e){t(e.data.user.username)})).catch(console.error)}(O||e,L)}),[O]),Object(b.jsxs)(i.a,{children:[O?Object(b.jsxs)("h1",{className:"greeting",children:["Welcome ",B]}):Object(b.jsx)("p",{children:"You are not signed in."}),Object(b.jsx)("nav",{className:"navbar navbar-default gray-background",children:Object(b.jsxs)("div",{className:"container",children:[O?Object(b.jsxs)(i.b,{to:"/",children:[" ",Object(b.jsx)("button",{className:"btn btn-default navbar-btn",children:"Home"})," "]}):null,Object(b.jsxs)(i.b,{to:"/posts",children:[" ",Object(b.jsx)("button",{className:"btn btn-default navbar-btn",children:"Posts"})," "]}),Object(b.jsxs)(i.b,{to:"/login",children:[" ",Object(b.jsx)("button",{className:"btn btn-default navbar-btn",children:"Login / Logout"})," "]}),Object(b.jsxs)(i.b,{to:"/register",children:[" ",Object(b.jsx)("button",{className:"btn btn-default navbar-btn",children:"Register"})," "]}),O?Object(b.jsxs)(i.b,{to:"/newpost",children:[" ",Object(b.jsx)("button",{className:"btn btn-default navbar-btn",children:"Make New Post"})," "]}):null]})}),Object(b.jsx)(l.a,{path:"/posts",render:function(e){return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"title",children:Object(b.jsx)("h1",{children:"Posts"})}),Object(b.jsx)(f,{setSearchTerm:C,searchTerm:T,setPostsToDisplay:q,posts:s}),D.map((function(t,s){return Object(b.jsx)(h,Object(n.a)({element:t,token:O,setPosts:o,setPostsToDisplay:q,username:B},e),s)}))]})}}),Object(b.jsx)(l.a,{path:"/login",children:O?Object(b.jsx)(k,{setToken:m}):Object(b.jsx)(x,{mode:"login",setToken:m})}),Object(b.jsx)(l.a,{path:"/register",children:O?Object(b.jsx)(k,{setToken:m}):Object(b.jsx)(x,{mode:"register",setToken:m})}),Object(b.jsx)(l.a,{path:"/newpost",render:function(e){return Object(b.jsx)(p,Object(n.a)(Object(n.a)({token:O},e),{},{setPosts:o,setPostsToDisplay:q}))}}),Object(b.jsx)(l.a,{exact:!0,path:"/",render:function(e){return Object(b.jsx)(v,Object(n.a)(Object(n.a)({},e),{},{token:O}))}}),Object(b.jsx)(l.a,{path:"/edit/:postid",render:function(e){return Object(b.jsx)(N,Object(n.a)(Object(n.a)({},e),{},{token:O,setPosts:o,setPostsToDisplay:q,posts:s,findPost:y}))}})]})};a.a.render(Object(b.jsx)(P,{}),document.getElementById("app"))}},[[29,1,2]]]);
//# sourceMappingURL=main.c3f4b7bb.chunk.js.map